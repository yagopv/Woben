define(["plugins/router","services/appsecurity","services/errorhandler","services/entitymanagerprovider","model/modelBuilder","services/appsecurity"],function(e,t,r,n,a,t){n.modelBuilder=a.extendMetadata;var o={attached:function(){$(document).find("footer").show()},activate:function(){var r=this;return n.prepare().then(function(){return e.makeRelative({moduleId:"viewmodels"}),e.guardRoute=function(e,r){if(sessionStorage.redirectTo){var n=sessionStorage.redirectTo;return sessionStorage.removeItem("redirectTo"),n}return r.config.authorize?"undefined"!=typeof t.userInfo()?t.isUserInRole(r.config.authorize)?r.config.confirmed?t.userInfo().isEmailConfirmed()?!0:(t.showConfirmationWarning(!0),"/account/login?returnUrl="+encodeURIComponent(r.fragment)):!0:"/account/login?returnUrl="+encodeURIComponent(r.fragment):"/account/login?returnUrl="+encodeURIComponent(r.fragment):!0},e.map([{route:["","home/index"],moduleId:"home/index",title:"Home",nav:!0,hash:"#home/index"},{route:"home/articles",moduleId:"home/articles",title:"Articles",nav:!0,hash:"#home/articles"},{route:"home/help",moduleId:"home/help",title:"Help",nav:!0,hash:"#home/help"},{route:"home/about",moduleId:"home/about",title:"About",nav:!0,hash:"#home/about"},{route:"notfound",moduleId:"notfound",title:"Not found",nav:!1},{route:"admin/panel",moduleId:"admin/panel",title:"Admin Panel",nav:!1,hash:"#admin/panel",authorize:["Administrator"]},{route:"account/login",moduleId:"account/login",title:"Login",nav:!1,hash:"#account/login"},{route:"account/externalloginconfirmation",moduleId:"account/externalloginconfirmation",title:"External login confirmation",nav:!1,hash:"#account/externalloginconfirmation"},{route:"account/externalloginfailure",moduleId:"account/externalloginfailure",title:"External login failure",nav:!1,hash:"#account/externalloginfailure"},{route:"account/register",moduleId:"account/register",title:"Register",nav:!1,hash:"#account/register"},{route:"account/manage",moduleId:"account/manage",title:"Manage account",nav:!1,hash:"#account/manage",authorize:["User","Administrator"]},{route:"account/registrationcomplete",moduleId:"account/registrationcomplete",title:"Registration complete",nav:!1,hash:"#account/registrationcomplete"},{route:"account/forgotpassword",moduleId:"account/forgotpassword",title:"Forgot password",nav:!1,hash:"#account/forgotpassword"},{route:"account/resetpassword",moduleId:"account/resetpassword",title:"Reset password",nav:!1,hash:"#account/resetpassword"},{route:"user/dashboard",moduleId:"user/dashboard",title:"Dashboard",nav:!1,hash:"#user/dashboard",authorize:["User"],confirmed:!0},{route:":createdby/:categorycode/:articlecode",moduleId:"user/article",title:"Article",nav:!1}]).buildNavigationModel().mapUnknownRoutes("notfound","notfound").activate({pushState:!0})}).fail(r.handlevalidationerrors)}};return r.includeIn(o),o});