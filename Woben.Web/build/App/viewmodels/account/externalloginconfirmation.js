define(["services/appsecurity","plugins/router","services/errorhandler","services/utils"],function(e,t,r,n){var a=ko.observable(),i=ko.observable().extend({required:!0}),o=ko.observable().extend({required:!0,email:!0}),s=ko.observable(),l=ko.observable(),c=ko.observable(),u={loginProvider:a,userName:i,email:o,activate:function(){var e=this;return ga("send","pageview",{page:window.location.href,title:document.title}),e.loginProvider(n.getUrlParameter("loginProvider")),e.userName(n.getUrlParameter("userName")),s=n.getUrlParameter("access_token"),l=decodeURIComponent(n.getUrlParameter("loginUrl")),c=n.getUrlParameter("state"),!0},confirmexternalaccount:function(){var t=this;return 0!=this.errors().length?(this.errors.showAllMessages(),void 0):(e.registerExternal(s,{userName:t.userName(),email:t.email()}).done(function(){sessionStorage.state=c,sessionStorage.redirectTo="account/manage",e.archiveSessionStorageToLocalStorage(),window.location=l}).fail(t.handlevalidationerrors),void 0)}};return r.includeIn(u),u.errors=ko.validation.group(u),u});