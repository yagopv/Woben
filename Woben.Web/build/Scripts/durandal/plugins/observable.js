define(["durandal/system","durandal/binder","knockout"],function(e,t,n){function r(e){var t=e[0];return"_"===t||"$"===t}function a(t){return!(!t||void 0===t.nodeType||!e.isNumber(t.nodeType))}function i(e){if(!e||a(e)||e.ko===n||e.jquery)return!1;var t=f.call(e);return-1==v.indexOf(t)&&!(e===!0||e===!1)}function o(e,t){var n=e.__observable__,r=!0;if(!n||!n.__full__){n=n||(e.__observable__={}),n.__full__=!0,h.forEach(function(n){e[n]=function(){r=!1;var e=b[n].apply(t,arguments);return r=!0,e}}),g.forEach(function(n){e[n]=function(){r&&t.valueWillMutate();var a=m[n].apply(e,arguments);return r&&t.valueHasMutated(),a}}),p.forEach(function(n){e[n]=function(){for(var a=0,i=arguments.length;i>a;a++)s(arguments[a]);r&&t.valueWillMutate();var o=m[n].apply(e,arguments);return r&&t.valueHasMutated(),o}}),e.splice=function(){for(var n=2,a=arguments.length;a>n;n++)s(arguments[n]);r&&t.valueWillMutate();var i=m.splice.apply(e,arguments);return r&&t.valueHasMutated(),i};for(var a=0,i=e.length;i>a;a++)s(e[a])}}function s(t){var a,s;if(i(t)&&(a=t.__observable__,!a||!a.__full__)){if(a=a||(t.__observable__={}),a.__full__=!0,e.isArray(t)){var l=n.observableArray(t);o(t,l)}else for(var u in t)r(u)||a[u]||(s=t[u],e.isFunction(s)||c(t,u,s));w&&e.log("Converted",t)}}function l(e,t,n){var r;e(t),r=e.peek(),n?r?r.destroyAll||o(r,e):(r=[],e(r),o(r,e)):s(r)}function c(t,r,a){var i,c,u=t.__observable__||(t.__observable__={});if(void 0===a&&(a=t[r]),e.isArray(a))i=n.observableArray(a),o(a,i),c=!0;else if("function"==typeof a){if(!n.isObservable(a))return null;i=a}else e.isPromise(a)?(i=n.observable(),a.then(function(t){if(e.isArray(t)){var r=n.observableArray(t);o(t,r),t=r}i(t)})):(i=n.observable(a),s(a));return Object.defineProperty(t,r,{configurable:!0,enumerable:!0,get:i,set:n.isWriteableObservable(i)?function(t){t&&e.isPromise(t)?t.then(function(t){l(i,t,e.isArray(t))}):l(i,t,c)}:void 0}),u[r]=i,i}function u(t,r,a){var i,o={owner:t,deferEvaluation:!0};return"function"==typeof a?o.read=a:("value"in a&&e.error('For defineProperty, you must not specify a "value" for the property. You must provide a "get" function.'),"function"!=typeof a.get&&e.error('For defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".'),o.read=a.get,o.write=a.set),i=n.computed(o),t[r]=i,c(t,r,i)}var d,f=Object.prototype.toString,v=["[object Function]","[object String]","[object Boolean]","[object Number]","[object Date]","[object RegExp]"],h=["remove","removeAll","destroy","destroyAll","replace"],g=["pop","reverse","sort","shift","splice"],p=["push","unshift"],m=Array.prototype,b=n.observableArray.fn,w=!1;return d=function(e,t){var r,a,i;return e?(r=e.__observable__,r&&(a=r[t])?a:(i=e[t],n.isObservable(i)?i:c(e,t,i))):null},d.defineProperty=u,d.convertProperty=c,d.convertObject=s,d.install=function(e){var n=t.binding;t.binding=function(e,t,r){r.applyBindings&&!r.skipConversion&&s(e),n(e,t)},w=e.logConversion},d});