define(["durandal/system"],function(e){return{typeAttribute:"type",space:void 0,replacer:function(e,t){if(e){var r=e[0];if("_"===r||"$"===r)return void 0}return t},serialize:function(t,r){return r=void 0===r?{}:r,(e.isString(r)||e.isNumber(r))&&(r={space:r}),JSON.stringify(t,r.replacer||this.replacer,r.space||this.space)},getTypeId:function(e){return e?e[this.typeAttribute]:void 0},typeMap:{},registerType:function(){var t=arguments[0];if(1==arguments.length){var r=t[this.typeAttribute]||e.getModuleId(t);this.typeMap[r]=t}else this.typeMap[t]=arguments[1]},reviver:function(e,t,r,n){var a=r(t);if(a){var i=n(a);if(i)return i.fromJSON?i.fromJSON(t):new i(t)}return t},deserialize:function(e,t){var r=this;t=t||{};var n=t.getTypeId||function(e){return r.getTypeId(e)},a=t.getConstructor||function(e){return r.typeMap[e]},i=t.reviver||function(e,t){return r.reviver(e,t,n,a)};return JSON.parse(e,i)}}});